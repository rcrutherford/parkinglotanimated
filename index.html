<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script type="text/javascript" src="space.js"></script>
	<script type="text/javascript" src="lane.js"></script>
	<script type="text/javascript" src="car.js"></script>
	<script type="text/javascript">
		
		var windowWidth = 0;
		var lotHeight = 0;
		var lotWidth = 0;
		var lotLeft = 0;
		var bottomIgnore = 0;
		var topIgnore = 0;
		var leftIgnore = 0;
		var spacesHeight = 0;
		var spaceSmallestDim = 0;
		var spaceLargestDim = 0;
		var onePctWidth = 0;
		var onePctHeight = 0;
		var carImg = {};
		var car={};


		window.onload = function () {
			lot = document.getElementById("lot");
			windowWidth = parseInt(getComputedStyle(lot).width.replace('px',''));
			lotHeight = parseInt(getComputedStyle(lot).height.replace('px',''));
			lotWidth = lotHeight * 1.333333333;
			if (windowWidth<lotWidth){
				alert("Please make window width wider than parkinglot!")
			}
			lotLeft = (windowWidth - lotWidth )/2;
			bottomIgnore = lotHeight*.02117;
			topIgnore = lotHeight*.01466;
			leftIgnore = lotWidth*.010975;
			spacesHeight =lotHeight -bottomIgnore - topIgnore;
			spaceSmallestDim = spacesHeight / 9;
			spaceLargestDim = spaceSmallestDim * 1.75;
			onePctWidth = lotWidth/100;
			onePctHeight = spacesHeight/100;

			createSpaces();
			createLanes();

			var eventProxy = document.getElementById("eventProxy");
			
			carImg = document.getElementById('car1');
			intersectionA = document.getElementById('intersectionA');
			intersectionB = document.getElementById('intersectionB');
			intersectionC = document.getElementById('intersectionC');
			intersectionD = document.getElementById('intersectionD');

			car = new Car(carImg, space5, intersectionA, intersectionB, intersectionC, intersectionD);
						
			eventProxy.addEventListener('tick',car.observeTime);

			var intervalId = setInterval(fireTick, 33.3333);
			var myTimeOut = setTimeout(function() {clearInterval(intervalId);},6000);

			function fireTick() {
				let event = new Event('tick');
				eventProxy.dispatchEvent(event);
			}

		};
	</script>	
	<style type="text/css">
		 body, html {
	        height: 100%;
	        margin: 0;
	    }
		.bg {
	        /* The image used */
	        background-image: url("images/parkinglot86.jpg");
	        /* Full height */
	        height: 100%; 

	        /* Center and scale the image*/
	        background-position: center;
	        background-repeat: no-repeat;
	        background-size: contain;
	        border: solid red 2px;
	        /*position: relative;*/
	    }
	    .space {
	    	border: solid green 1px;
	    	position: absolute;
	    	display: flex;
		    align-items: center;
		    justify-content: center;
  			
	    }
	    .lane {
	    	border: solid blue 1px;
	    	position: absolute;
	    	display: flex;
		    align-items: center;
		    justify-content: center;
	    }
	    .car {
			position: absolute;
			border: solid black 1px;
		}
		 .intersection {
	    	border: solid red 1px;
	    	position: absolute;
	    	display: flex;
		    align-items: center;
		    justify-content: center;
	    }

	</style>
</head>
<body>
	<div id="lot" class="bg">
		
	</div>
		<img id="car1" class = "car" src="images/car-blue.png" />
	<br id="eventProxy">
</body>
</html>